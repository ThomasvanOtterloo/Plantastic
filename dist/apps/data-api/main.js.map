{"version":3,"file":"main.js","mappings":"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","sources":["webpack://Plantastic/./apps/data-api/src/app/api-response.interceptor.ts","webpack://Plantastic/./apps/data-api/src/app/app.module.ts","webpack://Plantastic/./apps/data-api/src/app/auth/auth.controller.ts","webpack://Plantastic/./apps/data-api/src/app/auth/auth.module.ts","webpack://Plantastic/./apps/data-api/src/app/auth/auth.service.ts","webpack://Plantastic/./apps/data-api/src/app/auth/identity.schema.ts","webpack://Plantastic/./apps/data-api/src/app/auth/token.decorator.ts","webpack://Plantastic/./apps/data-api/src/app/auth/token.middleware.ts","webpack://Plantastic/./apps/data-api/src/app/data.module.ts","webpack://Plantastic/./apps/data-api/src/app/product/product.controller.ts","webpack://Plantastic/./apps/data-api/src/app/product/product.schema.ts","webpack://Plantastic/./apps/data-api/src/app/product/product.service.ts","webpack://Plantastic/./apps/data-api/src/app/user/user.controller.ts","webpack://Plantastic/./apps/data-api/src/app/user/user.schema.ts","webpack://Plantastic/./apps/data-api/src/app/user/user.service.ts","webpack://Plantastic/./libs/data/src/index.ts","webpack://Plantastic/external commonjs \"@nestjs/common\"","webpack://Plantastic/external commonjs \"@nestjs/core\"","webpack://Plantastic/external commonjs \"@nestjs/mongoose\"","webpack://Plantastic/external commonjs \"bcrypt\"","webpack://Plantastic/external commonjs \"jsonwebtoken\"","webpack://Plantastic/external commonjs \"mongoose\"","webpack://Plantastic/external commonjs \"rxjs/operators\"","webpack://Plantastic/external commonjs \"tslib\"","webpack://Plantastic/external commonjs \"uuid\"","webpack://Plantastic/webpack/bootstrap","webpack://Plantastic/./apps/data-api/src/main.ts"],"sourcesContent":["import { ApiResponse } from '@find-a-buddy/data';\nimport { Injectable, NestInterceptor, ExecutionContext, CallHandler } from '@nestjs/common';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\n\n@Injectable()\nexport class ApiResponseInterceptor implements NestInterceptor {\n  intercept(context: ExecutionContext, next: CallHandler): Observable<ApiResponse<unknown>> {\n    return next\n      .handle()\n      .pipe(\n        map(results => {\n            if (results) {\n                return {\n                    results,\n                    info: {\n                        version: '1.0',\n                        type: results instanceof Array ? 'list' : 'object',\n                        count: results instanceof Array ? results.length : 1,\n                    }\n                }\n            } else {\n                return {\n                    results: undefined,\n                    info: {\n                        version: '1.0',\n                        type: 'none',\n                        count: 0,\n                    }\n                }\n            }\n        }\n      ));\n  }\n}\n","import { MiddlewareConsumer, Module } from '@nestjs/common';\nimport { RouterModule } from '@nestjs/core';\n\nimport { MongooseModule } from '@nestjs/mongoose';\n\nimport { AuthModule } from './auth/auth.module';\nimport { TokenMiddleware } from './auth/token.middleware';\nimport { DataModule } from './data.module';\n\n@Module({\n  imports: [\n    MongooseModule.forRoot(\n      // `mongodb+srv://${process.env.MONGO_USR}:${process.env.MONGO_PWD}@${process.env.MONGO_HOST}/${process.env.MONGO_DATABASE}?retryWrites=true&w=majority`\n      `mongodb://${process.env.MONGO_HOST}/${process.env.MONGO_DATABASE}`\n    ),\n    AuthModule,\n    DataModule,\n    RouterModule.register([\n      {\n        path: 'auth-api',\n        module: AuthModule,\n      },\n      {\n        path: 'data-api',\n        module: DataModule,\n      },\n    ]),\n  ],\n  controllers: [],\n  providers: [],\n})\nexport class AppModule {\n  configure(consumer: MiddlewareConsumer) {\n    consumer.apply(TokenMiddleware).forRoutes('data-api');\n  }\n}\n\n","import { Body, Controller, HttpException, HttpStatus, Post } from '@nestjs/common';\n\nimport { ResourceId, Token, UserRegistration } from '@find-a-buddy/data';\n\nimport { AuthService } from './auth.service';\n\n@Controller()\nexport class AuthController {\n    constructor(private readonly authService: AuthService) {}\n\n    @Post('register')\n    async register(@Body() credentials: UserRegistration): Promise<ResourceId> {\n        console.log('register', credentials);\n        try {\n            await this.authService.registerUser(credentials.username, credentials.password);\n            console.log('register succeeded');\n            return {\n                id: await this.authService.createUser(credentials.username),\n            };\n        } catch (e) {\n            throw new HttpException('Username invalid' + e, HttpStatus.BAD_REQUEST);\n        }\n    }\n\n    @Post('login')\n    async login(@Body() credentials: UserRegistration): Promise<Token> {\n        console.log('login inside controller', credentials);\n        try {\n            return {\n\n                token: await this.authService.generateToken(credentials.username, credentials.password)\n            };\n        } catch (e) {\n            throw new HttpException('Invalid credentials', HttpStatus.UNAUTHORIZED);\n        }\n    }\n}\n","import { Module } from '@nestjs/common';\nimport { MongooseModule } from '@nestjs/mongoose';\n\nimport { AuthController } from './auth.controller';\n\nimport { Identity, IdentitySchema } from './identity.schema';\nimport { User, UserSchema } from '../user/user.schema';\nimport { AuthService } from './auth.service';\n\n@Module({\n  imports: [\n    MongooseModule.forFeature([\n      { name: Identity.name, schema: IdentitySchema },\n      { name: User.name, schema: UserSchema }\n    ]),\n  ],\n  controllers: [AuthController],\n  providers: [AuthService],\n  exports: [AuthService],\n})\nexport class AuthModule {\n\n}","import { Injectable } from '@nestjs/common';\n\nimport { JwtPayload, verify, sign } from 'jsonwebtoken';\nimport { hash, compare } from 'bcrypt';\n\nimport { Model } from 'mongoose';\nimport { InjectModel } from '@nestjs/mongoose';\n\nimport { Identity, IdentityDocument } from './identity.schema';\nimport { User, UserDocument } from '../user/user.schema';\n\n@Injectable()\nexport class AuthService {\n    constructor(\n        @InjectModel(Identity.name) private identityModel: Model<IdentityDocument>,\n        @InjectModel(User.name) private userModel: Model<UserDocument>\n    ) {}\n\n    async createUser(username: string): Promise<string> {\n        const user = new this.userModel({username});\n\n        await user.save();\n        return user.id;\n      }\n\n    async verifyToken(token: string): Promise<string | JwtPayload> {\n        return new Promise((resolve, reject) => {\n            verify(token, process.env.JWT_SECRET, (err, payload) => {\n                if (err) reject(err);\n                else resolve(payload);\n            })\n        })\n    }\n\n    async registerUser(username: string, password: string) {\n        const generatedHash = await hash(password, parseInt(process.env.SALT_ROUNDS, 10));\n\n        const identity = new this.identityModel({username, hash: generatedHash});\n\n        console.log('registerUser', identity);\n\n        await identity.save();\n    }\n\n    async generateToken(username: string, password: string): Promise<string> {\n        const identity = await this.identityModel.findOne({username});\n\n        if (!identity || !(await compare(password, identity.hash))) throw new Error(\"user not authorized\");\n\n        const user = await this.userModel.findOne({name: username});\n\n        return new Promise((resolve, reject) => {\n            sign({username, id: user.id}, process.env.JWT_SECRET, (err: Error, token: string) => {\n                if (err) reject(err);\n                else resolve(token);\n            });\n        })\n    }\n}\n","import { Prop, Schema, SchemaFactory } from '@nestjs/mongoose';\nimport { Document } from 'mongoose';\n\nexport type IdentityDocument = Identity & Document;\n\n@Schema()\nexport class Identity {\n    @Prop({\n        required: true,\n        unique: true,\n    })\n    username: string;\n\n    @Prop({required: true})\n    hash: string;\n\n}\n\nexport const IdentitySchema = SchemaFactory.createForClass(Identity);\n","import { createParamDecorator, ExecutionContext } from '@nestjs/common';\n\nimport { Id } from '@find-a-buddy/data';\n\nexport interface Token {\n  username: Id,\n  id: string,\n}\n\nexport const InjectToken = createParamDecorator(\n  (_data: unknown, ctx: ExecutionContext) => {\n    const response = ctx.switchToHttp().getResponse();\n    return response.locals.token;\n  },\n);","import { HttpException, HttpStatus, Injectable, NestMiddleware } from '@nestjs/common';\nimport { Request, Response, NextFunction } from 'express';\n\nimport { AuthService } from './auth.service';\n\n@Injectable()\nexport class TokenMiddleware implements NestMiddleware {\n  constructor(private authService: AuthService) {}\n\n  async use(req: Request, res: Response, next: NextFunction) {\n    const authHeader = req.header('authorization');\n\n    if (!authHeader) {\n      throw new HttpException('No authorization header', HttpStatus.UNAUTHORIZED);\n    }\n\n    try {\n      const token = await this.authService.verifyToken(authHeader);\n      \n      res.locals.token = token;\n    } catch (e) {\n      throw new HttpException('Token invalid', HttpStatus.UNAUTHORIZED);\n    }\n\n    next();\n  }\n}\n","import { Module } from '@nestjs/common';\nimport { MongooseModule } from '@nestjs/mongoose';\n\n// import { TopicController } from './topic/topic.controller';\n// import { MeetupService } from './meetup/meetup.service';\n// import { TopicService } from './topic/topic.service';\nimport { ProductService} from \"./product/product.service\";\nimport { UserService } from './user/user.service';\n\nimport { User, UserSchema } from './user/user.schema';\n// import { Topic, TopicSchema } from './topic/topic.schema';\n// import { Meetup, MeetupSchema } from './meetup/meetup.schema';\nimport { Product, ProductSchema } from './product/product.schema';\nimport { UserController } from './user/user.controller';\nimport { ProductController } from './product/product.controller';\n// import { MeetupController } from './meetup/meetup.controller';\n\n@Module({\n  imports: [\n    MongooseModule.forFeature([\n      { name: User.name, schema: UserSchema },\n      { name: Product.name, schema: ProductSchema },\n      // { name: Topic.name, schema: TopicSchema },\n      // { name: Meetup.name, schema: MeetupSchema }\n    ]),\n  ],\n  controllers: [\n    // MeetupController,\n    // TopicController,\n    UserController,\n    ProductController\n\n  ],\n  providers: [\n    UserService,\n    ProductService,\n    // TopicService,\n    // MeetupService,\n  ],\n})\nexport class DataModule {}\n","\nimport {Body, Controller, Get, HttpException, Param, Post} from '@nestjs/common';\n\n\nimport { Product, User } from '@find-a-buddy/data';\nimport { InjectToken, Token } from '../auth/token.decorator';\nimport {ProductService} from \"./product.service\";\n\n@Controller('product')\nexport class ProductController {\n    constructor(private readonly productService: ProductService) {}\n\n    @Get()\n    async getAll(): Promise<Product[]> {\n        return this.productService.getAll();\n    }\n\n\n\n    @Get(':id')\n    async getOne(@Param('id') id: string): Promise<Product> {\n        return this.productService.getOne(id);\n    }\n\n\n    @Post()\n    async create(@InjectToken() token: Token,  @Body() product: Product): Promise<Product> {\n        try {\n            return await this.productService.create(product, token.id);\n        }\n        catch (e) {\n            console.log('error', e);\n            throw new HttpException('Error creating product >' + e, 500);\n        }\n    }\n\n\n\n}\n","import { Prop, Schema, SchemaFactory } from '@nestjs/mongoose';\nimport { Document, Schema as MongooseSchema } from 'mongoose';\nimport { v4 as uuid } from 'uuid';\nimport isEmail from 'validator/lib/isEmail';\nimport {Category, Review, User} from \"@find-a-buddy/data\";\n// import { Meetup } from '../meetup/meetup.schema';\n\nexport type ProductDocument = Product & Document;\n\n@Schema()\nexport class Product {\n  @Prop({default: uuid, index: true})\n  id: string;\n\n  @Prop({\n    required: true,\n    unique: false,\n  })\n  name: string;\n\n  @Prop({\n    required: true,\n  })\n  description: string;\n\n  @Prop({\n    required: true,\n    validate: [rating => rating >= 0 && rating <= 10, 'Rating must be between 0 and 10'],\n  })\n  rating: number;\n\n\n  @Prop({\n    required: true,\n  })\n  price: number;\n\n  @Prop({\n    required: true,\n  })\n  quantity: number;\n\n  @Prop({\n    required: true,\n  })\n  author: string;\n\n  @Prop({\n    required: false,\n  })\n  image: string;\n\n  @Prop({default: []})\n  reviews: Review[];\n\n  @Prop({\n    default: [],\n    required: true,\n  })\n  category: Category[];\n\n\n}\n\nexport const ProductSchema = SchemaFactory.createForClass(Product);\n","import {Injectable} from '@nestjs/common';\n\nimport {Model} from 'mongoose';\nimport {InjectModel} from '@nestjs/mongoose';\n\nimport {Product as ProductModel, ProductDocument} from './product.schema';\nimport {Category, Id, Product, Review} from '@find-a-buddy/data';\nimport {User, UserDocument} from \"../user/user.schema\";\n\n\n@Injectable()\nexport class ProductService {\n  constructor(\n    @InjectModel(ProductModel.name) private productModel: Model<ProductDocument>,\n    @InjectModel(User.name) private userModel: Model<UserDocument>\n  ) {}\n\n  async getAll(): Promise<Product[]> {\n    return this.productModel.aggregate([\n        {\n            $lookup: {\n                from: 'products',\n                localField: 'products',\n                foreignField: 'id',\n                as: 'products',\n            }\n\n        },\n        {\n            $group: {\n                _id: '$_id',\n                id: {$first: '$id'},\n                author: {$first: '$author'},\n                name: {$first: '$name'},\n                description: {$first: '$description'},\n                image: {$first: '$image'},\n                rating: {$first: '$rating'},\n                quantity: {$first: '$quantity'},\n                price: {$first: '$price'},\n                reviews: {$first: '$reviews'},\n                category: {$first: '$category'},\n            }\n        }\n\n\n\n\n\n    ]);\n  }\n\n\n\n  async getOne(productId: string): Promise<Product | null> {\n    const products = await this.productModel.aggregate([\n        {\n            $match: {\n                id: productId,\n            }\n        },\n        {\n            $group: {\n                _id: '$_id',\n                id: {$first: '$id'},\n                author: {$first: '$author'},\n                name: {$first: '$name'},\n                description: {$first: '$description'},\n                image: {$first: '$image'},\n                rating: {$first: '$rating'},\n                quantity: {$first: '$quantity'},\n                price: {$first: '$price'},\n                reviews: {$first: '$reviews'},\n                category: {$first: '$category'},\n\n\n\n            }\n        }\n\n    ]);\n\n    return products[0];\n  }\n\n  async create(product: Product, authorId: string): Promise<Product> {\n    const author = await this.userModel.findOne({ id: authorId });\n    if (!author) {\n        throw new Error('AuthorId not found');\n    }\n\n\n    const newProduct = new this.productModel({\n        author: author.id,\n        name: product.name,\n        description: product.description,\n        image: product.image,\n        rating: product.rating,\n        quantity: product.quantity,\n        price: product.price,\n        reviews: product.reviews,\n        category: product.category\n    });\n\n    author.products.push(newProduct);\n\n    await Promise.all([newProduct.save(), author.save()]);\n\n    return newProduct;\n  }\n}\n","import {Controller, Get, Param} from '@nestjs/common';\n\nimport {UserService} from './user.service';\n\nimport {User, UserInfo} from '@find-a-buddy/data';\nimport {InjectToken, Token} from '../auth/token.decorator';\n\n@Controller('user')\nexport class UserController {\n  constructor(private readonly userService: UserService) {}\n\n  @Get()\n  async getAll(): Promise<UserInfo[]> {\n    return this.userService.getAll();\n  }\n\n  // this method should precede the general getOne method, otherwise it never matches\n  @Get('self')\n  async getSelf(@InjectToken() token: Token): Promise<User> {\n    console.log('token CurrentLogger:', token);\n    return await this.userService.getOne(token.id);\n  }\n\n  @Get(':id')\n  async getOne(@Param('id') id: string): Promise<User> {\n    return this.userService.getOne(id);\n  }\n}\n","import { Prop, Schema, SchemaFactory } from '@nestjs/mongoose';\nimport { Document, Schema as MongooseSchema } from 'mongoose';\nimport { v4 as uuid } from 'uuid';\nimport isEmail from 'validator/lib/isEmail';\nimport {Product, Review} from \"@find-a-buddy/data\";\n\n// import { Meetup } from '../meetup/meetup.schema';\n\nexport type UserDocument = User & Document;\n\n@Schema()\nexport class User {\n  @Prop({default: uuid, index: true})\n  id: string;\n\n  @Prop({\n    required: true,\n    unique: true,\n  })\n  username: string;\n\n  @Prop({\n    default: 500,\n    unique: false,\n  })\n  wallet: number;\n\n  @Prop({default: []})\n  friends: User[];\n\n  @Prop({default: []})\n  products: Product[];\n\n  @Prop({default: []})\n  reviews: Review[];\n\n}\n\nexport const UserSchema = SchemaFactory.createForClass(User);\n","import { Injectable } from '@nestjs/common';\n\nimport { Model } from 'mongoose';\nimport { InjectModel } from '@nestjs/mongoose';\n\nimport { User as UserModel, UserDocument } from './user.schema';\n\nimport { User, UserInfo } from '@find-a-buddy/data';\n\n@Injectable()\nexport class UserService {\n  constructor(\n    @InjectModel(UserModel.name) private userModel: Model<UserDocument>,\n    // @InjectModel(Meetup.name) private meetupModel: Model<MeetupDocument>\n  ) {}\n\n  async getAll(): Promise<UserInfo[]> {\n    return this.userModel.aggregate([{\n      $lookup: {\n        from: 'meetups',\n        localField: 'meetups',\n        foreignField: '_id',\n        as: 'meetups',\n      }},\n        {$group: {\n            _id: '$_id',\n            id: {$first: '$id'},\n            username: {$first: '$username'},\n            wallet: {$first: '$wallet'},\n            products: {$push: '$products'},\n            reviews: {$push: '$reviews'},\n            friends: {$push: '$friends'}\n          },\n        }]);\n  }\n\n  async getOne(userId: string): Promise<User | null> {\n    console.log('model', this.userModel);\n    const users = await this.userModel.aggregate([{\n      $match: {\n          id: userId,\n        }},\n      {$group: {\n          _id: '$_id',\n          id: {$first: '$id'},\n          username: {$first: '$username'},\n          wallet: {$first: '$wallet'},\n          products: {$push: '$products'},\n          reviews: {$push: '$reviews'},\n          friends: {$push: '$friends'},\n        }\n      }]);\n\n\n\n    console.log('users', users);\n    return users[0];\n  }\n}\n","export * from './lib/id.type';\nexport * from './lib/category';\nexport * from './lib/product';\nexport * from './lib/review.interface';\nexport * from './lib/user.interface';\nexport * from './lib/api-response.interface';\nexport * from './lib/auth.interface';\n","module.exports = require(\"@nestjs/common\");","module.exports = require(\"@nestjs/core\");","module.exports = require(\"@nestjs/mongoose\");","module.exports = require(\"bcrypt\");","module.exports = require(\"jsonwebtoken\");","module.exports = require(\"mongoose\");","module.exports = require(\"rxjs/operators\");","module.exports = require(\"tslib\");","module.exports = require(\"uuid\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","/**\n * This is not a production server yet!\n * This is only a minimal backend to get started.\n */\n\nimport { Logger } from '@nestjs/common';\nimport { NestFactory } from '@nestjs/core';\nimport { ApiResponseInterceptor } from './app/api-response.interceptor';\n\nimport { AppModule } from './app/app.module';\n\nasync function bootstrap() {\n  const app = await NestFactory.create(AppModule);\n  app.enableCors();\n  // const globalPrefix = 'data-api';\n  // app.setGlobalPrefix(globalPrefix);\n\n  app.useGlobalInterceptors(new ApiResponseInterceptor());\n\n  const port = process.env.PORT || 3333;\n  await app.listen(port);\n  \n  Logger.log(\n    `🚀 Data API is running on: ${await app.getUrl()}`\n  );\n}\n\nbootstrap();\n"],"names":[],"sourceRoot":""}